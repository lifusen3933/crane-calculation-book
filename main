#!/usr/bin/env python3
"""
èµ·é‡æœºè®¾è®¡è®¡ç®—ä¹¦è‡ªåŠ¨ç”Ÿæˆç³»ç»Ÿ
ä¸»ç¨‹åºå…¥å£
"""
import sys
import os


def print_banner():
    """æ‰“å°æ¬¢è¿æ¨ªå¹…"""
    print("\n" + "=" * 80)
    print("  ğŸ—ï¸  èµ·é‡æœºè®¾è®¡è®¡ç®—ä¹¦è‡ªåŠ¨ç”Ÿæˆç³»ç»Ÿ")
    print("     Crane Design Calculation Book Generator")
    print("=" * 80)
    print()


def main():
    """ä¸»å‡½æ•°"""
    print_banner()

    if len(sys.argv) > 1:
        # å‘½ä»¤è¡Œå‚æ•°æ¨¡å¼
        interface = sys.argv[1].lower()
    else:
        # äº¤äº’å¼é€‰æ‹©
        print("è¯·é€‰æ‹©ç•Œé¢ç±»å‹:")
        print("1. å‘½ä»¤è¡Œç•Œé¢ (CLI)")
        print("2. Webç•Œé¢ (Streamlit)")
        print("3. æŸ¥çœ‹å¸®åŠ©")
        print()
        choice = input("é€‰æ‹© (1-3): ").strip()

        if choice == '3' or choice.lower() in ['help', 'h', '--help', '-h']:
            show_help()
            return
        elif choice == '2':
            interface = 'web'
        else:
            interface = 'cli'

    # å¯åŠ¨ç›¸åº”ç•Œé¢
    if interface in ['cli', '1']:
        print("\nå¯åŠ¨å‘½ä»¤è¡Œç•Œé¢...")
        from ui.cli_interface import main as cli_main
        cli_main()
    elif interface in ['web', '2', 'streamlit']:
        print("\nå¯åŠ¨Webç•Œé¢...")
        print("æµè§ˆå™¨å°†è‡ªåŠ¨æ‰“å¼€ http://localhost:8501")
        print("æŒ‰ Ctrl+C åœæ­¢æœåŠ¡å™¨")
        print()
        from ui.web_interface import main as web_main
        web_main()
    else:
        print(f"\nâŒ é”™è¯¯: æœªçŸ¥çš„ç•Œé¢ç±»å‹ '{interface}'")
        print("è¯·ä½¿ç”¨: python main.py cli æˆ– python main.py web")
        show_help()


def show_help():
    """æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯"""
    print("\n" + "=" * 80)
    print("å¸®åŠ©ä¿¡æ¯")
    print("=" * 80)
    print("""
ä½¿ç”¨æ–¹æ³•:
    python main.py [ç•Œé¢ç±»å‹]

ç•Œé¢ç±»å‹:
    cli         å‘½ä»¤è¡Œç•Œé¢ (äº¤äº’å¼è¾“å…¥)
    web         Webç•Œé¢ (éœ€è¦Streamlit)

ç¤ºä¾‹:
    python main.py cli          # å¯åŠ¨å‘½ä»¤è¡Œç•Œé¢
    python main.py web          # å¯åŠ¨Webç•Œé¢

ç³»ç»ŸåŠŸèƒ½:
    - èµ·é‡æœºè½½è·åˆ†æ
    - ç»“æ„å¼ºåº¦è®¡ç®—
    - æœºæ„è®¾è®¡è®¡ç®—
    - ç¨³å®šæ€§åˆ†æ
    - è‡ªåŠ¨ç”Ÿæˆè®¡ç®—ä¹¦

æŠ€æœ¯ç‰¹ç‚¹:
    - éµå¾ªGB/T 3811-2008ã€Šèµ·é‡æœºè®¾è®¡è§„èŒƒã€‹
    - æ”¯æŒæ¡¥å¼ã€é—¨å¼ã€åŠé—¨å¼èµ·é‡æœº
    - è‡ªåŠ¨ç”Ÿæˆå®Œæ•´è®¡ç®—ä¹¦æ–‡æ¡£

æ›´å¤šä¿¡æ¯:
    - æŸ¥çœ‹ README.md äº†è§£è¯¦ç»†è¯´æ˜
    - æŸ¥çœ‹ ç³»ç»Ÿè®¾è®¡æ–‡æ¡£.md äº†è§£æŠ€æœ¯æ¶æ„

    """)


if __name__ == "__main__":
    try:
        main()
    except KeyboardInterrupt:
        print("\n\nğŸ‘‹ ç¨‹åºå·²é€€å‡º")
    except Exception as e:
        print(f"\nâŒ ç¨‹åºå‘ç”Ÿé”™è¯¯: {e}")
        import traceback
        traceback.print_exc()

